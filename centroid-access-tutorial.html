<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Min. Dist Access Analysis | centroid-access-tutorial.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Min. Dist Access Analysis | centroid-access-tutorial.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Min. Dist Access Analysis | centroid-access-tutorial.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path=""><a href="#min-distance"><i class="fa fa-check"></i><b>1</b> Min. Dist Access Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#CA-research-question"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#CA-setup"><i class="fa fa-check"></i><b>1.2</b> Environment Setup</a><ul>
<li class="chapter" data-level="1.2.1" data-path=""><a href="#CA-packages1"><i class="fa fa-check"></i><b>1.2.1</b> Packages used</a></li>
<li class="chapter" data-level="1.2.2" data-path=""><a href="#CA-i-o"><i class="fa fa-check"></i><b>1.2.2</b> Required Inputs and Expected Outputs</a></li>
<li class="chapter" data-level="1.2.3" data-path=""><a href="#CA-packages2"><i class="fa fa-check"></i><b>1.2.3</b> Load the packages</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#CA-read-resources"><i class="fa fa-check"></i><b>1.3</b> Load data</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#CA-calculate-centroids"><i class="fa fa-check"></i><b>1.4</b> Calculate centroids</a><ul>
<li class="chapter" data-level="1.4.1" data-path=""><a href="#visualize-confirm"><i class="fa fa-check"></i><b>1.4.1</b> Visualize &amp; Confirm</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#CA-correct-projection"><i class="fa fa-check"></i><b>1.5</b> Standardize CRS</a></li>
<li class="chapter" data-level="" data-path=""><a href="#CA-distance"><i class="fa fa-check"></i>Calculate min distance</a><ul>
<li class="chapter" data-level="1.5.1" data-path=""><a href="#merge-data-back-to-area-data"><i class="fa fa-check"></i><b>1.5.1</b> Merge data back to Area Data</a></li>
<li class="chapter" data-level="1.5.2" data-path=""><a href="#visualize-confirm-1"><i class="fa fa-check"></i><b>1.5.2</b> Visualize &amp; Confirm</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path=""><a href="#CA-save"><i class="fa fa-check"></i><b>1.6</b> Save Data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="min-distance" class="section level1">
<h1><span class="header-section-number">1</span> Min. Dist Access Analysis</h1>
<div id="CA-research-question" class="section level2">
<h2><span class="header-section-number">1.1</span> Overview</h2>
<p>Spatial Access to specific resource is often considered a multidimensional concept where accessibility can be measured on affordability, availability, accommodation &amp; acceptability [<strong>include reference</strong>]. Distance to the nearest resource is a common metric used to capture the availability of a resource, and in this tutorial we demonstrate how to calculate a minimum distance value from a zip code centroid to a set of resources, such as locations of methadone clinics. Each zip code will be assigned a “minimum distance access metric” as a value that indicates access to resources from that zip code. Our objectives are thus to:</p>
<ul>
<li>Generate centroids from areal data</li>
<li>Calculate minimum distance from resources to area centroids</li>
<li>Overlay resources and new minimum distance metric</li>
</ul>
</div>
<div id="CA-setup" class="section level2">
<h2><span class="header-section-number">1.2</span> Environment Setup</h2>
<p>To replicate the codes &amp; functions illustrated in this tutorial, you’ll need to have R and RStudio downloaded and installed on your system. This tutorial assumes some familiarity with the R programming language.</p>
<div id="CA-packages1" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Packages used</h3>
<p>We will use the following packages in this tutorial:</p>
<ul>
<li><code>sf</code>: to manipulate spatial data</li>
<li><code>tmap</code>: to visualize and create maps</li>
<li><code>units</code>: to convert units within spatial data</li>
</ul>
</div>
<div id="CA-i-o" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Required Inputs and Expected Outputs</h3>
<p>Our inputs will be:</p>
<ul>
<li>a CSV file with the locations of our resources (“chicago_methadone.csv”), and</li>
<li>a zip code boundary file (“chicago_zips.shp”).</li>
</ul>
<p>We will calculate the minimum distance between the resources and the centroids of the zip codes, then save the results as a shapefile and as a CSV. Our final result will be a shapefile/CSV with the minimum distance value for each zip.</p>
</div>
<div id="CA-packages2" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Load the packages</h3>
<p>Load the libraries for use.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(sf)</a></code></pre></div>
<pre><code>## Warning: package &#39;sf&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Linking to GEOS 3.7.2, GDAL 2.4.2, PROJ 5.2.0</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(tmap)</a></code></pre></div>
<pre><code>## Warning: replacing previous import &#39;sf::st_make_valid&#39; by
## &#39;lwgeom::st_make_valid&#39; when loading &#39;tmap&#39;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(units)</a></code></pre></div>
<pre><code>## Warning: package &#39;units&#39; was built under R version 3.6.2</code></pre>
<pre><code>## udunits system database from /Library/Frameworks/R.framework/Versions/3.6/Resources/library/units/share/udunits</code></pre>
</div>
</div>
<div id="CA-read-resources" class="section level2">
<h2><span class="header-section-number">1.3</span> Load data</h2>
<p>First, load in the MOUD resources shapefile. Let’s take a look at the first few rows of the dataset.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">meth_sf &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;methadoneClinics.shp&quot;</span>)</a></code></pre></div>
<pre><code>## Reading layer `methadoneClinics&#39; from data source `/Users/maryniakolak/code/opioid-environment-toolkit/methadoneClinics.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 27 features and 8 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: -87.7349 ymin: 41.68698 xmax: -87.57673 ymax: 41.96475
## CRS:            4326</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">head</span>(meth_sf)</a></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 8 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: -87.67818 ymin: 41.89268 xmax: -87.63409 ymax: 41.96475
## CRS:            4326
##   X                                                         Name
## 1 1                Chicago Treatment and Counseling Center, Inc.
## 2 2                      Sundace Methadone Treatment Center, LLC
## 3 3 Soft Landing Interventions/DBA Symetria Recovery of Lakeview
## 4 4                                        PDSSC - Chicago, Inc.
## 5 5                          Center for Addictive Problems, Inc.
## 6 6                                Family Guidance Centers, Inc.
##                   Address    City State   Zip
## 1 4453 North Broadway st. Chicago    IL 60640
## 2 4545 North Broadway St. Chicago    IL 60640
## 3    3934 N. Lincoln Ave. Chicago    IL 60613
## 4     2260 N. Elston Ave. Chicago    IL 60614
## 5        609 N. Wells St. Chicago    IL 60654
## 6     310 W. Chicago Ave. Chicago    IL 60654
##                                    fullAdd geo_method
## 1 4453 North Broadway st. Chicago IL 60640        osm
## 2 4545 North Broadway St. Chicago IL 60640        osm
## 3    3934 N. Lincoln Ave. Chicago IL 60613     census
## 4     2260 N. Elston Ave. Chicago IL 60614     census
## 5        609 N. Wells St. Chicago IL 60654     census
## 6     310 W. Chicago Ave. Chicago IL 60654     census
##                     geometry
## 1 POINT (-87.65566 41.96321)
## 2 POINT (-87.65694 41.96475)
## 3 POINT (-87.67818 41.95331)
## 4 POINT (-87.67407 41.92269)
## 5 POINT (-87.63409 41.89268)
## 6 POINT (-87.63636 41.89657)</code></pre>
<p>If you don’t have a shapefile of your data, but already have geographic coordinates as two columns in your CSV file, you can still use this tutorial. A reminder of how to transform your CSV with coordinates into a spatial data frame in R can be found <a href="link%20to%20end%20of%20the%20geocoding%20tutorial">here</a>.</p>
<p>Next, we’ll load Chicago zip code boundaries.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">chicago_zips &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;data/chicago_zips.shp&quot;</span>)</a></code></pre></div>
<p>We can quickly plot our data for to confirm they loaded correctly, here using an interactive map:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">tm_shape</span>(chicago_zips) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">tm_shape</span>(meth_sf) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw">tm_dots</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="centroid-access-tutorial_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="CA-calculate-centroids" class="section level2">
<h2><span class="header-section-number">1.4</span> Calculate centroids</h2>
<p>Now, we will calculate the centroids of the zip code boundaries. We will first need to project our data, which means change it from latitude and longitude to meaningful units, like ft or meters, so we can calculate distance properly. We’ll use the Illinois State Plane projection, with an EPSG code of 3435.</p>
<p><strong>Aside</strong>: To find the most appropriate projection for your data, do a Google Search for which projection works well - for state level data, each state has a State Plane projection with a specific code, known as the EPSG. I use epsg.io to check projections - here’s the <a href="https://epsg.io/2263">New York State Plane</a> page.</p>
<p>Use the <code>st_transform</code> function to change the projection of the data. Notice how the values in <code>geometry</code> go from being relatively small (unprojected, lat/long) to very large (projected, in US feet).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">chicago_zips &lt;-<span class="st"> </span><span class="kw">st_transform</span>(chicago_zips, <span class="dv">3435</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">chicago_zips</a></code></pre></div>
<pre><code>## Simple feature collection with 85 features and 9 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 1058388 ymin: 1791133 xmax: 1205317 ymax: 1966816
## CRS:            EPSG:3435
## # A tibble: 85 x 10
##    ZCTA5CE10 GEOID10 CLASSFP10 MTFCC10 FUNCSTAT10 ALAND10 AWATER10 INTPTLAT10
##  * &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;     
##  1 60501     60501   B5        G6350   S          125322… 974360   +41.78022…
##  2 60007     60007   B5        G6350   S          364933… 917560   +42.00860…
##  3 60651     60651   B5        G6350   S          9052862 0        +41.90209…
##  4 60652     60652   B5        G6350   S          129878… 0        +41.74793…
##  5 60653     60653   B5        G6350   S          6041418 1696670  +41.81996…
##  6 60654     60654   B5        G6350   S          1464813 113471   +41.89182…
##  7 60655     60655   B5        G6350   S          114080… 0        +41.69477…
##  8 60656     60656   B5        G6350   S          8465226 0        +41.97428…
##  9 60657     60657   B5        G6350   S          5888324 2025836  +41.94029…
## 10 60659     60659   B5        G6350   S          5251086 2818     +41.99148…
## # … with 75 more rows, and 2 more variables: INTPTLON10 &lt;chr&gt;,
## #   geometry &lt;MULTIPOLYGON [US_survey_foot]&gt;</code></pre>
<p>Then, we will calculate the centroids:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">chicago_centroids &lt;-<span class="st"> </span><span class="kw">st_centroid</span>(chicago_zips)</a></code></pre></div>
<pre><code>## Warning in st_centroid.sf(chicago_zips): st_centroid assumes attributes are
## constant over geometries of x</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">chicago_centroids</a></code></pre></div>
<pre><code>## Simple feature collection with 85 features and 9 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 1076716 ymin: 1802621 xmax: 1198093 ymax: 1956017
## CRS:            EPSG:3435
## # A tibble: 85 x 10
##    ZCTA5CE10 GEOID10 CLASSFP10 MTFCC10 FUNCSTAT10 ALAND10 AWATER10 INTPTLAT10
##  * &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;     
##  1 60501     60501   B5        G6350   S          125322… 974360   +41.78022…
##  2 60007     60007   B5        G6350   S          364933… 917560   +42.00860…
##  3 60651     60651   B5        G6350   S          9052862 0        +41.90209…
##  4 60652     60652   B5        G6350   S          129878… 0        +41.74793…
##  5 60653     60653   B5        G6350   S          6041418 1696670  +41.81996…
##  6 60654     60654   B5        G6350   S          1464813 113471   +41.89182…
##  7 60655     60655   B5        G6350   S          114080… 0        +41.69477…
##  8 60656     60656   B5        G6350   S          8465226 0        +41.97428…
##  9 60657     60657   B5        G6350   S          5888324 2025836  +41.94029…
## 10 60659     60659   B5        G6350   S          5251086 2818     +41.99148…
## # … with 75 more rows, and 2 more variables: INTPTLON10 &lt;chr&gt;, geometry &lt;POINT
## #   [US_survey_foot]&gt;</code></pre>
<p>For each zip code, this will calculate the centroid, and the output will be a point dataset.</p>
<p>Plot to double check that everything is ok. The <code>st_geometry()</code> function will once again just return the outline:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(chicago_zips))</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(chicago_centroids), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="centroid-access-tutorial_files/figure-html/plot-zips-centroids-1.png" width="672" /></p>
<div id="visualize-confirm" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Visualize &amp; Confirm</h3>
<p>Once again, we can create an interactive map:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">tm_shape</span>(chicago_zips) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="kw">tm_shape</span>(chicago_centroids) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">tm_dots</span>()</a></code></pre></div>
<p><img src="centroid-access-tutorial_files/figure-html/plot-interactive-zips-centroids-1.png" width="672" /></p>
</div>
</div>
<div id="CA-correct-projection" class="section level2">
<h2><span class="header-section-number">1.5</span> Standardize CRS</h2>
<p>If we immediately try to calculate the distance between the zip centroids and the locations of the resources using the <code>st_distance</code> function, we’ll get an error:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">st_distance</span>(chicago_centroids, meth_sf, <span class="dt">by_element =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>Error in st_distance(chicago_centroids, meth_sf, by_element = TRUE) : st_crs(x) == st_crs(y) is not TRUE</code></pre>
<p>Why is there an error? Because the projection of the centroids and the resource locations don’t match up. Let’s project the resource locations so that they match the projection of the centroids.</p>
<p>First, use the <code>st_crs</code> function to check that the coordinate reference system (or projection) is the same. They’re not, so we have to fix it.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">st_crs</span>(chicago_centroids)</a></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: EPSG:3435 
##   wkt:
## PROJCS[&quot;NAD83 / Illinois East (ftUS)&quot;,
##     GEOGCS[&quot;NAD83&quot;,
##         DATUM[&quot;North_American_Datum_1983&quot;,
##             SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],
##             TOWGS84[0,0,0,0,0,0,0],
##             AUTHORITY[&quot;EPSG&quot;,&quot;6269&quot;]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],
##         UNIT[&quot;degree&quot;,0.0174532925199433,
##             AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],
##         AUTHORITY[&quot;EPSG&quot;,&quot;4269&quot;]],
##     PROJECTION[&quot;Transverse_Mercator&quot;],
##     PARAMETER[&quot;latitude_of_origin&quot;,36.66666666666666],
##     PARAMETER[&quot;central_meridian&quot;,-88.33333333333333],
##     PARAMETER[&quot;scale_factor&quot;,0.999975],
##     PARAMETER[&quot;false_easting&quot;,984250.0000000002],
##     PARAMETER[&quot;false_northing&quot;,0],
##     UNIT[&quot;US survey foot&quot;,0.3048006096012192,
##         AUTHORITY[&quot;EPSG&quot;,&quot;9003&quot;]],
##     AXIS[&quot;X&quot;,EAST],
##     AXIS[&quot;Y&quot;,NORTH],
##     AUTHORITY[&quot;EPSG&quot;,&quot;3435&quot;]]</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">st_crs</span>(meth_sf)</a></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: 4326 
##   wkt:
## GEOGCS[&quot;WGS 84&quot;,
##     DATUM[&quot;WGS_1984&quot;,
##         SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,
##             AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],
##         AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],
##     UNIT[&quot;degree&quot;,0.0174532925199433,
##         AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],
##     AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</code></pre>
<p>We’ll take the CRS from the zip code centroids data, and use it as input to <code>st_transform</code> applied to the methadone clinics data.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">new_crs &lt;-<span class="st"> </span><span class="kw">st_crs</span>(chicago_centroids)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">new_crs</a></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: EPSG:3435 
##   wkt:
## PROJCS[&quot;NAD83 / Illinois East (ftUS)&quot;,
##     GEOGCS[&quot;NAD83&quot;,
##         DATUM[&quot;North_American_Datum_1983&quot;,
##             SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],
##             TOWGS84[0,0,0,0,0,0,0],
##             AUTHORITY[&quot;EPSG&quot;,&quot;6269&quot;]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],
##         UNIT[&quot;degree&quot;,0.0174532925199433,
##             AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],
##         AUTHORITY[&quot;EPSG&quot;,&quot;4269&quot;]],
##     PROJECTION[&quot;Transverse_Mercator&quot;],
##     PARAMETER[&quot;latitude_of_origin&quot;,36.66666666666666],
##     PARAMETER[&quot;central_meridian&quot;,-88.33333333333333],
##     PARAMETER[&quot;scale_factor&quot;,0.999975],
##     PARAMETER[&quot;false_easting&quot;,984250.0000000002],
##     PARAMETER[&quot;false_northing&quot;,0],
##     UNIT[&quot;US survey foot&quot;,0.3048006096012192,
##         AUTHORITY[&quot;EPSG&quot;,&quot;9003&quot;]],
##     AXIS[&quot;X&quot;,EAST],
##     AXIS[&quot;Y&quot;,NORTH],
##     AUTHORITY[&quot;EPSG&quot;,&quot;3435&quot;]]</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">meth_sf &lt;-<span class="st"> </span><span class="kw">st_transform</span>(meth_sf, new_crs)</a></code></pre></div>
<p>If we check the CRS again, we now see that they match. <strong>Mismatched projections are a commonly made mistake in geospatial data processing.</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">st_crs</span>(chicago_centroids)</a></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: EPSG:3435 
##   wkt:
## PROJCS[&quot;NAD83 / Illinois East (ftUS)&quot;,
##     GEOGCS[&quot;NAD83&quot;,
##         DATUM[&quot;North_American_Datum_1983&quot;,
##             SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],
##             TOWGS84[0,0,0,0,0,0,0],
##             AUTHORITY[&quot;EPSG&quot;,&quot;6269&quot;]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],
##         UNIT[&quot;degree&quot;,0.0174532925199433,
##             AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],
##         AUTHORITY[&quot;EPSG&quot;,&quot;4269&quot;]],
##     PROJECTION[&quot;Transverse_Mercator&quot;],
##     PARAMETER[&quot;latitude_of_origin&quot;,36.66666666666666],
##     PARAMETER[&quot;central_meridian&quot;,-88.33333333333333],
##     PARAMETER[&quot;scale_factor&quot;,0.999975],
##     PARAMETER[&quot;false_easting&quot;,984250.0000000002],
##     PARAMETER[&quot;false_northing&quot;,0],
##     UNIT[&quot;US survey foot&quot;,0.3048006096012192,
##         AUTHORITY[&quot;EPSG&quot;,&quot;9003&quot;]],
##     AXIS[&quot;X&quot;,EAST],
##     AXIS[&quot;Y&quot;,NORTH],
##     AUTHORITY[&quot;EPSG&quot;,&quot;3435&quot;]]</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">st_crs</span>(meth_sf)</a></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: EPSG:3435 
##   wkt:
## PROJCS[&quot;NAD83 / Illinois East (ftUS)&quot;,
##     GEOGCS[&quot;NAD83&quot;,
##         DATUM[&quot;North_American_Datum_1983&quot;,
##             SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],
##             TOWGS84[0,0,0,0,0,0,0],
##             AUTHORITY[&quot;EPSG&quot;,&quot;6269&quot;]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],
##         UNIT[&quot;degree&quot;,0.0174532925199433,
##             AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],
##         AUTHORITY[&quot;EPSG&quot;,&quot;4269&quot;]],
##     PROJECTION[&quot;Transverse_Mercator&quot;],
##     PARAMETER[&quot;latitude_of_origin&quot;,36.66666666666666],
##     PARAMETER[&quot;central_meridian&quot;,-88.33333333333333],
##     PARAMETER[&quot;scale_factor&quot;,0.999975],
##     PARAMETER[&quot;false_easting&quot;,984250.0000000002],
##     PARAMETER[&quot;false_northing&quot;,0],
##     UNIT[&quot;US survey foot&quot;,0.3048006096012192,
##         AUTHORITY[&quot;EPSG&quot;,&quot;9003&quot;]],
##     AXIS[&quot;X&quot;,EAST],
##     AXIS[&quot;Y&quot;,NORTH],
##     AUTHORITY[&quot;EPSG&quot;,&quot;3435&quot;]]</code></pre>
<p>Now we have the zip boundaries, the centroids of the zips, and the resource locations, as shown below. Next, we will calculate the distance to the nearest resource from each zip code centroid.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(chicago_zips))</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(chicago_centroids), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(meth_sf), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="centroid-access-tutorial_files/figure-html/plot-zips-centroids-resources-1.png" width="672" /></p>
</div>
<div id="CA-distance" class="section level2 unnumbered">
<h2>Calculate min distance</h2>
<p>First, we’ll identify the resource that is the closest to a zip centroid using the <code>st_nearest_feature</code> function. (It will return the index of the object that is nearest, so we will subset the resources by the index to get the nearest object.)</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">nearest_clinic_indexes &lt;-<span class="st"> </span><span class="kw">st_nearest_feature</span>(chicago_centroids, meth_sf)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"></a>
<a class="sourceLine" id="cb37-3" data-line-number="3">nearest_clinic &lt;-<span class="st"> </span>meth_sf[nearest_clinic_indexes,]</a>
<a class="sourceLine" id="cb37-4" data-line-number="4"></a>
<a class="sourceLine" id="cb37-5" data-line-number="5">nearest_clinic</a></code></pre></div>
<pre><code>## Simple feature collection with 85 features and 8 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 1147259 ymin: 1829330 xmax: 1190680 ymax: 1930471
## CRS:            EPSG:3435
## First 10 features:
##       X                                                         Name
## 16   16                          Katherine Boone Robinson Foundation
## 7     7                                     A Rincon Family Services
## 7.1   7                                     A Rincon Family Services
## 26   26                            New Hope Community Service Center
## 15   15         HRDI- Grand Boulevard Professional Counseling Center
## 5     5                          Center for Addictive Problems, Inc.
## 26.1 26                            New Hope Community Service Center
## 7.2   7                                     A Rincon Family Services
## 1     1                Chicago Treatment and Counseling Center, Inc.
## 3     3 Soft Landing Interventions/DBA Symetria Recovery of Lakeview
##                      Address    City State   Zip
## 16        4100 W. Ogden Ave. Chicago    IL 60623
## 7         3809 W. Grand Ave. Chicago    IL 60651
## 7.1       3809 W. Grand Ave. Chicago    IL 60651
## 26          2559 W. 79th St. Chicago    IL 60652
## 15           340 E. 51st St. Chicago    IL 60615
## 5           609 N. Wells St. Chicago    IL 60654
## 26.1        2559 W. 79th St. Chicago    IL 60652
## 7.2       3809 W. Grand Ave. Chicago    IL 60651
## 1    4453 North Broadway st. Chicago    IL 60640
## 3       3934 N. Lincoln Ave. Chicago    IL 60613
##                                       fullAdd geo_method
## 16        4100 W. Ogden Ave. Chicago IL 60623     census
## 7         3809 W. Grand Ave. Chicago IL 60651     census
## 7.1       3809 W. Grand Ave. Chicago IL 60651     census
## 26          2559 W. 79th St. Chicago IL 60652        osm
## 15           340 E. 51st St. Chicago IL 60615     census
## 5           609 N. Wells St. Chicago IL 60654     census
## 26.1        2559 W. 79th St. Chicago IL 60652        osm
## 7.2       3809 W. Grand Ave. Chicago IL 60651     census
## 1    4453 North Broadway st. Chicago IL 60640        osm
## 3       3934 N. Lincoln Ave. Chicago IL 60613     census
##                     geometry
## 16   POINT (1149437 1888620)
## 7    POINT (1150707 1908328)
## 7.1  POINT (1150707 1908328)
## 26   POINT (1160422 1852071)
## 15   POINT (1179319 1871281)
## 5    POINT (1174632 1904257)
## 26.1 POINT (1160422 1852071)
## 7.2  POINT (1150707 1908328)
## 1    POINT (1168556 1929911)
## 3    POINT (1162460 1926257)</code></pre>
<p>Then, we will calculate the distance between the nearest resource and the zip code centroid with the <code>st_distance</code> function. As shown above, make sure both of your datasets are projected, and in the same projection, before you run <code>st_distance</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">min_dists &lt;-<span class="st"> </span><span class="kw">st_distance</span>(chicago_centroids, nearest_clinic, <span class="dt">by_element =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"></a>
<a class="sourceLine" id="cb39-3" data-line-number="3">min_dists</a></code></pre></div>
<pre><code>## Units: [US_survey_foot]
##  [1] 36764.471 82821.757  5237.764  7419.050  7241.215   873.991 20515.835
##  [8] 38337.779  8516.342 15479.988  9823.172  4447.705 33707.202 24111.173
## [15] 24184.991 45224.230 31198.648 10113.372 10890.143 13779.075 49874.400
## [22] 32463.844 36633.404 21981.243 13637.327 22151.171 63268.911  4242.008
## [29]  3749.998  5116.415  5530.724  8696.602  3965.649  4368.285  6998.725
## [36]  6937.025  3967.509 45944.187 32598.459 44548.952 58483.551  5416.487
## [43]  5728.851  2327.899  6646.411  5817.262   365.628 13619.270  7021.182
## [50]  5024.536  2829.488  1648.361  7709.690  2628.400  1521.495  9423.848
## [57] 16648.775  2185.237 11463.785 22537.644 11872.133  7759.662 39665.409
## [64] 11741.279 18689.070 27555.396  5301.820  8808.542 25363.914 18986.590
## [71] 26456.564  7562.917  3496.941 11023.379  3128.000 16826.923  6172.874
## [78] 25276.556 17290.797 15198.524 25164.072 18438.696 19972.965 33211.229
## [85] 22518.257</code></pre>
<p>This is in US feet. To change to a more meaningful unit, such as miles, we can use the <code>set_units()</code> function:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">min_dists_mi &lt;-<span class="st"> </span><span class="kw">set_units</span>(min_dists, <span class="st">&quot;mi&quot;</span>)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"></a>
<a class="sourceLine" id="cb41-3" data-line-number="3">min_dists_mi</a></code></pre></div>
<pre><code>## Units: [mi]
##  [1]  6.96298198 15.68597011  0.99200275  1.40512596  1.37144503  0.16552893
##  [7]  3.88558262  7.26095754  1.61294677  2.93182182  1.86045293  0.84236999
## [13]  6.38395252  4.56651915  4.58049994  8.56521226  5.90884663  1.91541520
## [19]  2.06253115  2.60967860  9.44592795  6.14846754  6.93815858  4.16312245
## [25]  2.58283224  4.19530595 11.98277234  0.80341215  0.71022833  0.96901998
## [31]  1.04748778  1.64708702  0.75107138  0.82732834  1.32551867  1.31383303
## [37]  0.75142366  8.70156788  6.17396283  8.43731838 11.07645233  1.02585189
## [43]  1.08501190  0.44089088  1.25879245  1.10175645  0.06924787  2.57941243
## [49]  1.32977202  0.95161851  0.53588899  0.31219014  1.46017146  0.49780409
## [55]  0.28816254  1.78482335  3.15318335  0.41387148  2.17117583  4.26850167
## [61]  2.24851459  1.46963585  7.51240307  2.22373150  3.53960367  5.21883539
## [67]  1.00413457  1.66828778  4.80378114  3.59595236  5.01072284  1.43237347
## [73]  0.66230081  2.08776534  0.59242542  3.18692368  1.16910723  4.78723618
## [79]  3.27477863  2.87851400  4.76593224  3.49218425  3.78276617  6.29001804
## [85]  4.26482998</code></pre>
<div id="merge-data-back-to-area-data" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Merge data back to Area Data</h3>
<p>We then rejoin the minimum distances to the zip code data, by column binding <code>min_dists_mi</code> to the original <code>chicago_zips</code> data.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">min_dist_sf &lt;-<span class="st"> </span><span class="kw">cbind</span>(chicago_zips, min_dists_mi)</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">min_dist_sf</a></code></pre></div>
<pre><code>## Simple feature collection with 85 features and 10 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 1058388 ymin: 1791133 xmax: 1205317 ymax: 1966816
## CRS:            EPSG:3435
## First 10 features:
##    ZCTA5CE10 GEOID10 CLASSFP10 MTFCC10 FUNCSTAT10  ALAND10 AWATER10  INTPTLAT10
## 1      60501   60501        B5   G6350          S 12532295   974360 +41.7802209
## 2      60007   60007        B5   G6350          S 36493383   917560 +42.0086000
## 3      60651   60651        B5   G6350          S  9052862        0 +41.9020934
## 4      60652   60652        B5   G6350          S 12987857        0 +41.7479319
## 5      60653   60653        B5   G6350          S  6041418  1696670 +41.8199645
## 6      60654   60654        B5   G6350          S  1464813   113471 +41.8918225
## 7      60655   60655        B5   G6350          S 11408010        0 +41.6947762
## 8      60656   60656        B5   G6350          S  8465226        0 +41.9742800
## 9      60657   60657        B5   G6350          S  5888324  2025836 +41.9402931
## 10     60659   60659        B5   G6350          S  5251086     2818 +41.9914885
##      INTPTLON10    min_dists_mi                       geometry
## 1  -087.8232440  6.9629820 [mi] MULTIPOLYGON (((1112613 185...
## 2  -087.9973398 15.6859701 [mi] MULTIPOLYGON (((1058389 194...
## 3  -087.7408565  0.9920027 [mi] MULTIPOLYGON (((1136069 190...
## 4  -087.7147951  1.4051260 [mi] MULTIPOLYGON (((1145542 185...
## 5  -087.6059654  1.3714450 [mi] MULTIPOLYGON (((1177007 187...
## 6  -087.6383036  0.1655289 [mi] MULTIPOLYGON (((1170904 190...
## 7  -087.7037764  3.8855826 [mi] MULTIPOLYGON (((1146378 183...
## 8  -087.8271283  7.2609575 [mi] MULTIPOLYGON (((1110359 193...
## 9  -087.6468569  1.6129468 [mi] MULTIPOLYGON (((1162394 192...
## 10 -087.7039859  2.9318218 [mi] MULTIPOLYGON (((1148555 194...</code></pre>
</div>
<div id="visualize-confirm-1" class="section level3">
<h3><span class="header-section-number">1.5.2</span> Visualize &amp; Confirm</h3>
<p>We can now visualize the zip-level access to methadone clinics using our new access metric, using the <code>tmap</code> package.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</a></code></pre></div>
<pre><code>## tmap mode set to plotting</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">tm_shape</span>(min_dist_sf) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;min_dists_mi&quot;</span>, </a>
<a class="sourceLine" id="cb47-3" data-line-number="3">              <span class="dt">title =</span> <span class="st">&quot;Minimum Distance (mi)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">main.title =</span> <span class="st">&quot;Minimum Distance from Zip Centroid</span><span class="ch">\n</span><span class="st"> to Methadone Clinic&quot;</span>,</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">            <span class="dt">main.title.position =</span> <span class="st">&quot;center&quot;</span>,</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">            <span class="dt">main.title.size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="centroid-access-tutorial_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Access by zip code can also be combined with locations of resources:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">tm_shape</span>(min_dist_sf) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;min_dists_mi&quot;</span>, <span class="dt">style =</span> <span class="st">&#39;jenks&#39;</span>,</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">              <span class="dt">title =</span> <span class="st">&quot;Minimum Distance (mi)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">  </span><span class="kw">tm_shape</span>(meth_sf) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-5" data-line-number="5"><span class="st">  </span><span class="kw">tm_dots</span>(<span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">main.title =</span> <span class="st">&quot;Minimum Distance from Zip Centroid</span><span class="ch">\n</span><span class="st"> to Methadone Clinic&quot;</span>,</a>
<a class="sourceLine" id="cb48-7" data-line-number="7">            <span class="dt">main.title.position =</span> <span class="st">&quot;center&quot;</span>,</a>
<a class="sourceLine" id="cb48-8" data-line-number="8">            <span class="dt">main.title.size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="centroid-access-tutorial_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="CA-save" class="section level2">
<h2><span class="header-section-number">1.6</span> Save Data</h2>
<p>To save our final result to a CSV, use the <code>layer_options = &quot;GEOMETRY=AS_XY&quot;</code> command. Note that this option only works when you are working with point data.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">write_sf</span>(min_dist_sf, <span class="st">&quot;min_dist.csv&quot;</span>, <span class="dt">layer_options =</span> <span class="st">&quot;GEOMETRY=AS_XY&quot;</span>)</a></code></pre></div>
<p>We can also write out this data to a shapefile format:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">write_sf</span>(min_dist_sf, <span class="st">&quot;min_dists_sf.shp&quot;</span>)</a></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"search": false
});
});
</script>

</body>

</html>
